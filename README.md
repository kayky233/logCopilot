# ğŸ“¡ LogPilot â€” åŸºç«™æ•…éšœæ·±åº¦åˆ¤å†³ç³»ç»Ÿ

> Multi-Agent AI é©±åŠ¨çš„åŸºç«™æ—¥å¿—è‡ªåŠ¨åŒ–æ•…éšœè¯Šæ–­å¹³å°

LogPilot æ˜¯ä¸€æ¬¾é¢å‘é€šä¿¡åŸºç«™è¿ç»´å›¢é˜Ÿçš„æ™ºèƒ½æ•…éšœåˆ¤å†³å·¥å…·ã€‚å®ƒé€šè¿‡ **å››ä¸ª AI Agent åä½œæµæ°´çº¿**ï¼Œå°†æ•…éšœæ‰‹å†ŒçŸ¥è¯†ä¸å®é™…æ—¥å¿—è¿›è¡Œæ·±åº¦æ¯”å¯¹ï¼Œè‡ªåŠ¨è¾“å‡ºç»“æ„åŒ–çš„æ•…éšœè¯Šæ–­æŠ¥å‘Šã€‚

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| ğŸ¤– **Multi-Agent Pipeline** | Manual â†’ Log â†’ Code â†’ Boss å››é˜¶æ®µåä½œåˆ¤å†³ |
| ğŸ“š **æ‰‹å†Œé©±åŠ¨** | å…ˆç ”è¯»æ•…éšœæ‰‹å†Œæå–åˆ¤æ®è§„åˆ™ï¼Œå†åˆ°æ—¥å¿—ä¸­ç²¾ç¡®æœè¯ |
| ğŸ’» **ä»£ç å®¡è®¡** | å¯é€‰æŒ‚è½½æœ¬åœ°ä»£ç åº“ï¼ŒAI è‡ªåŠ¨è¯»å–æŠ¥é”™ä½ç½®çš„æºç åˆ†ææ ¹å›  |
| ğŸ” **æ—¥å¿—æ™ºèƒ½åˆç­›** | åŸºäºå…³é”®è¯ + ä¸Šä¸‹æ–‡è¡Œçš„æ—¥å¿—é™å™ªï¼Œå¤§å¹…å‡å°‘ Token æ¶ˆè€— |
| ğŸ‘¥ **å¤šç”¨æˆ·éš”ç¦»** | ç‹¬ç«‹å·¥ä½œç©ºé—´ã€ç‹¬ç«‹é…ç½®ã€ç‹¬ç«‹å­˜å‚¨é…é¢ |
| âš¡ **LLM ç¼“å­˜** | æ‰‹å†Œç‰¹å¾è¯ 24h ç¼“å­˜ï¼Œé¿å…é‡å¤è°ƒç”¨ |
| ğŸ¢ **ç”Ÿäº§çº§åç«¯** | FastAPI + Celery + JWT è®¤è¯ï¼Œæ”¯æŒ 100+ å¹¶å‘ç”¨æˆ· |
| ğŸ“Š **æ‰¹é‡åˆ†æ & æŠ¥å‘Š** | æ‰¹é‡æäº¤ä»»åŠ¡ï¼Œå¯¼å‡º JSON / CSV / HTML æŠ¥å‘Š |
| ğŸ§  **å¤šæ¨¡å‹è·¯ç”±** | æŒ‰ä»»åŠ¡ç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ¨¡å‹ï¼Œå†…ç½®ç†”æ–­ä¿æŠ¤ |
| ğŸ“– **RAG çŸ¥è¯†åº“** | æ‰‹å†Œå‘é‡åŒ–è¯­ä¹‰æ£€ç´¢ï¼Œåƒçº§æ‰‹å†Œç§’çº§å¬å› |
| ğŸ’° **Token è®¡è´¹** | åˆ†æ¨¡å‹è®¡è´¹ç»Ÿè®¡ï¼Œç”¨æˆ·æ¯æ—¥é…é¢æ§åˆ¶ |

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Streamlit å‰ç«¯                      â”‚
â”‚  ç”¨æˆ·ä¸Šä¼ æ‰‹å†Œ/æ—¥å¿— â†’ é€‰æ‹©åœºæ™¯ â†’ æŸ¥çœ‹è¯Šæ–­æŠ¥å‘Š            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FastAPI åç«¯ (Phase 2)                    â”‚
â”‚  JWT è®¤è¯ â”‚ ä»»åŠ¡ç®¡ç† â”‚ æ–‡ä»¶ç®¡ç† â”‚ ç®¡ç†åå° â”‚ æŠ¥å‘Šå¯¼å‡º  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Multi-Agent Pipeline (æ ¸å¿ƒ)                  â”‚
â”‚                                                       â”‚
â”‚  ğŸ“š Manual Agent â”€â”€â†’ ğŸ•µï¸ Log Agent â”€â”€â†’ ğŸ’» Code Agent  â”‚
â”‚         â”‚                                    â”‚        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ğŸ§  Boss Agent â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                         â”‚                             â”‚
â”‚                    æœ€ç»ˆåˆ¤å†³æŠ¥å‘Š                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
logCopilot/
â”œâ”€â”€ app.py                          # Streamlit ä¸»å…¥å£
â”œâ”€â”€ ui.py                           # UI ç»„ä»¶
â”œâ”€â”€ utils.py                        # å·¥å…·åº“ (ç”¨æˆ·éš”ç¦»/ç¼“å­˜/æ–‡ä»¶IO)
â”œâ”€â”€ client.py                       # Pipeline å®¢æˆ·ç«¯
â”œâ”€â”€ agents.py                       # å››ä¸ª AI Agent å®šä¹‰
â”œâ”€â”€ code_utils.py                   # ä»£ç ç‰‡æ®µå®‰å…¨è¯»å–
â”‚
â”œâ”€â”€ backend/                        # FastAPI åç«¯
â”‚   â”œâ”€â”€ main.py                     # åç«¯å…¥å£
â”‚   â”œâ”€â”€ config.py                   # ç¯å¢ƒå˜é‡é…ç½®
â”‚   â”œâ”€â”€ auth.py                     # JWT è®¤è¯
â”‚   â”œâ”€â”€ database.py                 # å¼‚æ­¥æ•°æ®åº“
â”‚   â”œâ”€â”€ api/                        # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth_routes.py          #   è®¤è¯ (æ³¨å†Œ/ç™»å½•)
â”‚   â”‚   â”œâ”€â”€ task_routes.py          #   ä»»åŠ¡ (æäº¤/æŸ¥è¯¢/æ‰¹é‡)
â”‚   â”‚   â”œâ”€â”€ file_routes.py          #   æ–‡ä»¶ (ä¸Šä¼ /ä¸‹è½½/åˆ é™¤)
â”‚   â”‚   â”œâ”€â”€ admin_routes.py         #   ç®¡ç†åå°
â”‚   â”‚   â””â”€â”€ report_routes.py        #   æŠ¥å‘Šå¯¼å‡º
â”‚   â”œâ”€â”€ models/                     # æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ user.py                 #   ç”¨æˆ· (è§’è‰²/é…é¢)
â”‚   â”‚   â”œâ”€â”€ task.py                 #   åˆ†æä»»åŠ¡
â”‚   â”‚   â”œâ”€â”€ analysis.py             #   åˆ†æç»“æœ
â”‚   â”‚   â””â”€â”€ token_usage.py          #   Token æ¶ˆè€—è®°å½•
â”‚   â”œâ”€â”€ services/                   # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ model_router.py         #   å¤šæ¨¡å‹æ™ºèƒ½è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ rag_service.py          #   RAG å‘é‡æ£€ç´¢
â”‚   â”‚   â”œâ”€â”€ report_service.py       #   æŠ¥å‘Šç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ token_service.py        #   è®¡è´¹æœåŠ¡
â”‚   â””â”€â”€ workers/                    # å¼‚æ­¥ä»»åŠ¡
â”‚       â”œâ”€â”€ celery_app.py           #   Celery é…ç½®
â”‚       â””â”€â”€ analysis_worker.py      #   åˆ†æ Worker
â”‚
â”œâ”€â”€ docker/                         # å®¹å™¨åŒ–éƒ¨ç½²
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ docker-compose.yml          # ä¸€é”®ç¼–æ’ (5 ä¸ªæœåŠ¡)
â”‚   â””â”€â”€ nginx.conf                  # åå‘ä»£ç†
â”‚
â”œâ”€â”€ tests/                          # æµ‹è¯• (30 é¡¹)
â”‚   â”œâ”€â”€ test_phase1.py              # ç”¨æˆ·éš”ç¦»/ç¼“å­˜/å®‰å…¨
â”‚   â”œâ”€â”€ test_phase2_api.py          # API æ¥å£
â”‚   â””â”€â”€ test_phase3.py              # æ¨¡å‹è·¯ç”±/æŠ¥å‘Š/RAG
â”‚
â”œâ”€â”€ prompts/                        # Prompt æ¨¡æ¿ (å¯çƒ­ç¼–è¾‘)
â”œâ”€â”€ requirements.txt                # å‰ç«¯ä¾èµ–
â”œâ”€â”€ requirements-backend.txt        # åç«¯å®Œæ•´ä¾èµ–
â””â”€â”€ .env.example                    # ç¯å¢ƒå˜é‡æ¨¡æ¿
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šStreamlit å•æœºæ¨¡å¼ (å¼€å‘/æ¼”ç¤º)

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/kayky233/logCopilot.git
cd logCopilot

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 3. å¯åŠ¨
streamlit run app.py
```

æ‰“å¼€æµè§ˆå™¨ â†’ å·¦ä¾§è¾¹æ å¡«å…¥ **API Key** â†’ ä¸Šä¼ æ‰‹å†Œå’Œæ—¥å¿— â†’ ç‚¹å‡»æ‰«æã€‚

### æ–¹å¼äºŒï¼šDocker å…¨æ ˆéƒ¨ç½² (ç”Ÿäº§)

```bash
# 1. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .envï¼Œå¡«å…¥ SECRET_KEY ç­‰

# 2. ä¸€é”®å¯åŠ¨
docker-compose -f docker/docker-compose.yml up -d

# æœåŠ¡åœ°å€:
#   å‰ç«¯:  http://localhost (Nginx)
#   API:   http://localhost/api/v1
#   Docs:  http://localhost:8000/docs (Swagger)
```

### æ–¹å¼ä¸‰ï¼šæ‰‹åŠ¨å¯åŠ¨åç«¯ (å¼€å‘è°ƒè¯•)

```bash
pip install -r requirements-backend.txt

# å¯åŠ¨ Redis
redis-server

# å¯åŠ¨ FastAPI
uvicorn backend.main:app --host 0.0.0.0 --port 8000 --reload

# å¯åŠ¨ Celery Worker
celery -A backend.workers.celery_app worker -l info -Q analysis -c 4

# å¯åŠ¨å‰ç«¯
streamlit run app.py
```

---

## ğŸ”§ é…ç½®è¯´æ˜

### LLM é…ç½®

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| Base URL | `https://api.deepseek.com/v1` | å…¼å®¹ OpenAI æ ¼å¼çš„ API åœ°å€ |
| Model | `deepseek-chat` | æ¨¡å‹åç§° |
| API Key | â€” | åœ¨ä¾§è¾¹æ æˆ– `.env` ä¸­é…ç½® |

æ”¯æŒæ‰€æœ‰ OpenAI å…¼å®¹æ¥å£ï¼šDeepSeekã€é€šä¹‰åƒé—®ã€GPT-4oã€æœ¬åœ° Ollama ç­‰ã€‚

### æ‰‹å†Œæ ¼å¼

æ”¯æŒ `.md` / `.txt` / `.pdf` / `.docx` æ ¼å¼ã€‚æ¨è Markdownï¼Œç¤ºä¾‹ï¼š

```markdown
# æ•…éšœå®šä¹‰ï¼šç³»ç»Ÿä¸»æ—¶é’Ÿ PLL å¤±é”

## æ—¥å¿—ç‰¹å¾ (åˆ¤æ®)
1. `PLL status changed: LOCK -> UNLOCK`
2. `Fatal Error: System PLL lost lock, current_state=0x3`

## æ’æŸ¥æ­¥éª¤
1. æ£€æŸ¥ GPS å¤©çº¿è¿æ¥
2. æ£€æŸ¥å‚è€ƒæºé…ç½®
```

---

## ğŸ§ª è¿è¡Œæµ‹è¯•

```bash
# å…¨éƒ¨æµ‹è¯• (30 é¡¹)
python -m pytest tests/ -v

# æŒ‰é˜¶æ®µæµ‹è¯•
python -m pytest tests/test_phase1.py -v   # ç”¨æˆ·éš”ç¦»/ç¼“å­˜
python -m pytest tests/test_phase3.py -v   # æ¨¡å‹è·¯ç”±/æŠ¥å‘Š/RAG
```

---

## ğŸ“‹ API æ¥å£æ¦‚è§ˆ

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/api/v1/auth/register` | ç”¨æˆ·æ³¨å†Œ |
| POST | `/api/v1/auth/login` | ç™»å½•è·å– JWT |
| GET | `/api/v1/auth/me` | å½“å‰ç”¨æˆ·ä¿¡æ¯ |
| POST | `/api/v1/tasks/submit` | æäº¤åˆ†æä»»åŠ¡ |
| POST | `/api/v1/tasks/submit_batch` | æ‰¹é‡æäº¤ |
| GET | `/api/v1/tasks/status/{uid}` | æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€ |
| GET | `/api/v1/tasks/result/{uid}` | è·å–åˆ†æç»“æœ |
| GET | `/api/v1/tasks/list` | æˆ‘çš„ä»»åŠ¡åˆ—è¡¨ |
| POST | `/api/v1/files/upload/log` | ä¸Šä¼ æ—¥å¿— |
| POST | `/api/v1/files/upload/manual` | ä¸Šä¼ æ‰‹å†Œ |
| GET | `/api/v1/files/storage` | å­˜å‚¨ç”¨é‡ |
| GET | `/api/v1/reports/export/html` | å¯¼å‡º HTML æŠ¥å‘Š |
| GET | `/api/v1/reports/export/csv` | å¯¼å‡º CSV æŠ¥å‘Š |
| GET | `/api/v1/admin/stats` | ç³»ç»Ÿç»Ÿè®¡ (ç®¡ç†å‘˜) |
| GET | `/api/v1/admin/token_usage` | Token ç”¨é‡æŠ¥å‘Š |

å®Œæ•´æ–‡æ¡£å¯åŠ¨åè®¿é—®ï¼š`http://localhost:8000/docs`

---

## ğŸ—ºï¸ æ¼”è¿›è·¯çº¿

| é˜¶æ®µ | ç›®æ ‡ | çŠ¶æ€ |
|------|------|------|
| **Phase 1** | å•æœºåŠ å›ºï¼šç”¨æˆ·éš”ç¦»ã€ç¼“å­˜ã€æ–‡ä»¶é™åˆ¶ | âœ… å·²å®Œæˆ |
| **Phase 2** | ç”Ÿäº§æ¶æ„ï¼šFastAPI + JWT + Celery + Docker | âœ… å·²å®Œæˆ |
| **Phase 3** | è§„æ¨¡è¿è¥ï¼šå¤šæ¨¡å‹è·¯ç”±ã€RAGã€æŠ¥å‘Šã€è®¡è´¹ | âœ… å·²å®Œæˆ |
| Phase 4 | ğŸ”œ å‰ç«¯é‡æ„ (Vue/React)ã€LDAP/SSO å¯¹æ¥ | è§„åˆ’ä¸­ |
| Phase 5 | ğŸ”œ æŒç»­å­¦ä¹ ï¼šç”¨æˆ·åé¦ˆé—­ç¯ã€è‡ªåŠ¨æ›´æ–°åˆ¤æ® | è§„åˆ’ä¸­ |

---

## ğŸ“„ License

MIT License

---

> **LogPilot** â€” è®©æ¯ä¸€æ¬¡åŸºç«™å‘Šè­¦éƒ½æœ‰æ®å¯ä¾ ğŸ“¡
## Architecture Proposal

- Multi-component implementation and validation plan: `doc/architecture_implementation_validation_plan.md`
- Runnable core prototype: `backend/services/diagnosis_core.py`
- Low-cost validation runner: `backend/services/validation_service.py`

